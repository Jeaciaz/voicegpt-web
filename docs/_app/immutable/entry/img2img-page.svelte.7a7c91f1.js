import{S as N,i as U,s as G,y as b,z as $,A as v,g as q,d as w,B as I,k as _,a as k,l as g,c as R,m as S,h as m,n as c,N as h,b as p,O as M,P,Q as D,q as L,r as E,M as y,J as O,u as V,E as F,w as j,R as A,T as J,o as T}from"../chunks/index.72ff84a0.js";import{L as C,S as z,s as H,R as Q,a as W,b as B,g as K,c as X,p as Y}from"../chunks/SDForm.eff1c3cf.js";function Z(l){let e,n,t,a,u=l[3].name+"",f;return{c(){e=_("img"),t=k(),a=_("span"),f=L(u),this.h()},l(o){e=g(o,"IMG",{src:!0,alt:!0,class:!0}),t=R(o),a=g(o,"SPAN",{class:!0});var r=S(a);f=E(r,u),r.forEach(m),this.h()},h(){y(e.src,n=URL.createObjectURL(l[3]))||c(e,"src",n),c(e,"alt",""),c(e,"class","pr-2 h-8"),c(a,"class","whitespace-nowrap overflow-x-hidden text-ellipsis")},m(o,r){p(o,e,r),p(o,t,r),p(o,a,r),O(a,f)},p(o,r){r&8&&!y(e.src,n=URL.createObjectURL(o[3]))&&c(e,"src",n),r&8&&u!==(u=o[3].name+"")&&V(f,u)},d(o){o&&m(e),o&&m(t),o&&m(a)}}}function x(l){let e;return{c(){e=L("Выбрать изображение...")},l(n){e=E(n,"Выбрать изображение...")},m(n,t){p(n,e,t)},p:F,d(n){n&&m(e)}}}function ee(l){let e,n,t,a,u;function f(s,i){return s[3]?Z:x}let o=f(l),r=o(l);return{c(){e=_("input"),n=k(),t=_("div"),r.c(),this.h()},l(s){e=g(s,"INPUT",{type:!0,name:!0,class:!0,accept:!0}),n=R(s),t=g(s,"DIV",{class:!0});var i=S(t);r.l(i),i.forEach(m),this.h()},h(){c(e,"type","file"),c(e,"name",l[1]),e.required=l[2],c(e,"class","absolute opacity-0 svelte-cvpwnt"),c(e,"accept","image/png,image/jpeg"),c(t,"class","p-1 border rounded flex items-center h-10 input-replacement  svelte-cvpwnt"),h(t,"active",!!l[3]),h(t,"dirty",!!l[4])},m(s,i){p(s,e,i),p(s,n,i),p(s,t,i),r.m(t,null),a||(u=[M(e,"change",l[5]),M(e,"focus",P(l[6]))],a=!0)},p(s,i){i&2&&c(e,"name",s[1]),i&4&&(e.required=s[2]),o===(o=f(s))&&r?r.p(s,i):(r.d(1),r=o(s),r&&(r.c(),r.m(t,null))),i&8&&h(t,"active",!!s[3]),i&16&&h(t,"dirty",!!s[4])},d(s){s&&m(e),s&&m(n),s&&m(t),r.d(),a=!1,D(u)}}}function te(l){let e,n;return e=new C({props:{label:l[0],required:l[2],$$slots:{default:[ee]},$$scope:{ctx:l}}}),{c(){b(e.$$.fragment)},l(t){$(e.$$.fragment,t)},m(t,a){v(e,t,a),n=!0},p(t,[a]){const u={};a&1&&(u.label=t[0]),a&4&&(u.required=t[2]),a&158&&(u.$$scope={dirty:a,ctx:t}),e.$set(u)},i(t){n||(q(e.$$.fragment,t),n=!0)},o(t){w(e.$$.fragment,t),n=!1},d(t){I(e,t)}}}function ne(l,e,n){let{label:t=void 0}=e,{name:a=void 0}=e,{required:u=!1}=e,f,o=!1;const r=i=>{var d;return n(3,f=(d=i.currentTarget.files)==null?void 0:d[0])},s=()=>n(4,o=!0);return l.$$set=i=>{"label"in i&&n(0,t=i.label),"name"in i&&n(1,a=i.name),"required"in i&&n(2,u=i.required)},[t,a,u,f,o,r,s]}class se extends N{constructor(e){super(),U(this,e,ne,te,G,{label:0,name:1,required:2})}}function ae(l){let e,n;return e=new se({props:{slot:"pre-basic",name:"source_img",label:"Исходное изображение",required:!0}}),{c(){b(e.$$.fragment)},l(t){$(e.$$.fragment,t)},m(t,a){v(e,t,a),n=!0},p:F,i(t){n||(q(e.$$.fragment,t),n=!0)},o(t){w(e.$$.fragment,t),n=!1},d(t){I(e,t)}}}function re(l){let e,n;return e=new Q({props:{slot:"post-advanced",name:"denoising_strength",label:"Denoising strength",min:0,max:1,step:.05,defaultValue:.7}}),{c(){b(e.$$.fragment)},l(t){$(e.$$.fragment,t)},m(t,a){v(e,t,a),n=!0},p:F,i(t){n||(q(e.$$.fragment,t),n=!0)},o(t){w(e.$$.fragment,t),n=!1},d(t){I(e,t)}}}function le(l){let e,n,t,a,u,f;function o(s){l[3](s)}let r={onSubmit:l[2],parseExtra:ie,$$slots:{"post-advanced":[re],"pre-basic":[ae]},$$scope:{ctx:l}};return l[0]!==void 0&&(r.form=l[0]),a=new z({props:r}),j.push(()=>A(a,"form",o)),a.$on("input",l[1]),{c(){e=_("h1"),n=L("IMG -> IMG"),t=k(),b(a.$$.fragment),this.h()},l(s){e=g(s,"H1",{class:!0});var i=S(e);n=E(i,"IMG -> IMG"),i.forEach(m),t=R(s),$(a.$$.fragment,s),this.h()},h(){c(e,"class","text-center text-3xl")},m(s,i){p(s,e,i),O(e,n),p(s,t,i),v(a,s,i),f=!0},p(s,[i]){const d={};i&16&&(d.$$scope={dirty:i,ctx:s}),!u&&i&1&&(u=!0,d.form=s[0],J(()=>u=!1)),a.$set(d)},i(s){f||(q(a.$$.fragment,s),f=!0)},o(s){w(a.$$.fragment,s),f=!1},d(s){s&&m(e),s&&m(t),I(a,s)}}}function ie({source_img:l,denoising_strength:e,...n}){const t={...n,denoising_strength:Number(e)};return l instanceof File?new Promise((a,u)=>{const f=new FileReader;f.onload=()=>{var o,r;return a({...t,init_images:[((r=(o=String(f.result)).split)==null?void 0:r.call(o,",")[1])||null].filter(Boolean)})},f.onerror=u,f.readAsDataURL(l)}):t}function oe(l,e,n){let t;function a(){W(t.checkValidity())}function u(o){B(!0),console.log(o),K(JSON.stringify(o)).then(r=>({...r,operation:"img2img"})).then(r=>{X(r)}).catch(r=>{B(!1),Y(r,JSON.stringify,alert)})}T(()=>H(()=>t.requestSubmit()));function f(o){t=o,n(0,t)}return[t,a,u,f]}class ce extends N{constructor(e){super(),U(this,e,oe,le,G,{})}}export{ce as default};
